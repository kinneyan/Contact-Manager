<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Contacts</title>
        <link rel="stylesheet" href="css/styles.css">
        <link rel="stylesheet" href="css/contacts.css">
        <script type="text/javascript" src="js/main.js"></script>
        <script type="text/javascript" src="js/contacts.js"></script>
        <script type="text/javascript" src="js/user.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script type="text/javascript" src="js/cookie.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function(){
                //getCookie();
            }, {once: true});
        </script>
    </head>
    <body>
        <div class="banner">
            <h3><a href="index.html">Joe's Contact Manager</a></h3>
            <span><a href="#" id="logout-button" onclick="logout();">Log out</a></span>
        </div>
        <div id="contact-manager">
            <div class="buttons">
                <button id="add-contact" onclick="newContact();">New contact</button>
            </div>
            <div id="search">
                <label for="search-bar">Search contacts</label>
                <input id="search-bar" type="text">
                <button id="search-button" onclick="searchContacts();">Search</button>
            </div>
        </div>
        <div id="contacts">
            <div id="contacts-list">
                <table id="contacts-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                        </tr>
                    </thead>
                    <tbody id="contact-table-data">
                    </tbody>
                </table>
            </div>
            <div id="current-pane">
                <table id="current-contact">
                    <thead>
                        <tr>
                            <th>Contact details</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td id="current-name">
                                <span id="current-fname"></span>
                                <span id="current-lname"></span>
                            </td>
                        </tr>
                        <tr>
                            <td class="current-contact-details name-editor" id="fname-editor-data">
                                <label class="current-label" for="fname-editor" id="fname-label">First name</label>
                                <input class="current-data" type="text" id="fname-editor">
                            </td>
                        </tr>
                        <tr>
                            <td class="current-contact-details name-editor" id="lname-editor-data">
                                <label class="current-label" for="lname-editor" id="lname-label">Last name</label>
                                <input class="current-data" type="text" id="lname-editor">
                            </td>
                        </tr>
                        <tr>
                            <td class="current-contact-details">
                                <span class="current-label">Phone number</span>
                                <span class="current-data" id="current-phone"></span>
                                <input class="current-data field-editor" type="text" id="phone-editor">
                            </td>
                        </tr>
                        <tr>
                            <td class="current-contact-details">
                                <span class="current-label">Email</span>
                                <span class="current-data" id="current-email"></span>
                                <input class="current-data field-editor" type="text" id="email-editor">
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div id="modify-contact">
                    <button class="contact-button" id="cancel-button" onclick="resetFields()">Cancel</button>
                    <button class="contact-button" id="contact-edit-button" onclick="editContact();">Edit</button>
                    <button class="contact-button" id="contact-save-button" onclick="saveEdits();">Save</button>
                    <button class="contact-button" id="contact-delete-button">Delete</button>
                    <button class="contact-button" id="new-contact-save" onclick="createContact();">Create</button>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            // Get the input element
            var phoneInput = document.getElementById("phone-editor");

            // Add an event listener for input events
            phoneInput.addEventListener("input", function(event)
            {
                // Get the input value
                var inputValue = event.target.value;

                // Validate the input against the regular expression
                var regex = /^\(?[0-9]{3}\)?[-.\s]?[0-9]{3}[-.\s]?[0-9]{4}$/;
                if (!regex.test(inputValue))
                {
                    // If the input doesn't match the regular expression, remove the invalid characters
                    event.target.value = inputValue.replace(/[^0-9()-.\s]/g, '');
                }
            });

            var emailInput = document.getElementById("email-editor");

            emailInput.addEventListener("input", function(event)
            {
                // get input value
                var inputValue = event.target.value;

                // validate input
                var regex = /^[a-zA-Z0-9\-_+/\.]@[a-zA-Z0-9\-_+/\.].[a-zA-Z0-9\-_+/\.]$/;
                if (!regex.test(inputValue))
                {
                    event.target.value = inputValue.replace(/[^a-zA-Z0-9@._-]/g, '');
                }
            });
        </script>
    </body>
</html>
